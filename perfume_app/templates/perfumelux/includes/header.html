<header class="neu-outset" style="margin-bottom: 30px;">
    <div class="container">
        <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px 0;">
            <!-- Logo -->
            <div id="logo">
                <a href="{% url 'home' %}" style="text-decoration: none; color: var(--text-color);">
                    <h1 style="font-size: 24px; font-weight: 700; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-spray-can-sparkles" style="color: var(--accent-color);"></i>
<!--                        <span>PerfumeLux</span>-->
                    </h1>
                </a>
            </div>

            <!-- Desktop Navigation -->
            <nav style="display: flex; gap: 10px;">
                <a href="{% url 'product_list' %}" class="btn-neu">
                    <i class="fas fa-store"></i>
                    <span>Products</span>
                </a>
                <a href="{% url 'category_list' %}" class="btn-neu">
                    <i class="fas fa-tags"></i>
                    <span>Categories</span>
                </a>
                <a href="{% url 'about' %}" class="btn-neu">
                    <i class="fas fa-info-circle"></i>
                    <span>About</span>
                </a>
                <a href="{% url 'contact' %}" class="btn-neu">
                    <i class="fas fa-envelope"></i>
                    <span>Contact</span>
                </a>
            </nav>

            <!-- Right side icons -->
            <div style="display: flex; gap: 10px; align-items: center;">
                <!-- Theme Toggle -->
                <button id="theme-toggle" class="btn-neu" style="padding: 10px;" aria-label="Toggle dark mode">
                    <i class="fas fa-moon"></i>
                </button>

                <!-- Search -->
                <div class="search-container" style="position: relative;">
                    <form action="{% url 'search' %}" method="GET" style="display: flex;">
                        <input type="text" name="q" placeholder="Search..." class="form-control" style="width: 200px;">
                        <button type="submit" class="btn-neu" style="margin-left: 10px; padding: 10px 15px;" aria-label="Search">
                            <i class="fas fa-search"></i>
                        </button>
                    </form>
                </div>

                <!-- User account -->
                {% if user.is_authenticated %}
                <a href="{% url 'order_history' %}" class="btn-neu" style="padding: 10px;" aria-label="My account">
                    <i class="fas fa-user"></i>
                </a>
                {% else %}
                <a href="{% url 'login' %}" class="btn-neu" style="padding: 10px;" aria-label="Login">
                    <i class="fas fa-user"></i>
                </a>
                {% endif %}

                <!-- Wishlist -->
                {% if user.is_authenticated %}
                <a href="{% url 'wishlist' %}" class="btn-neu" style="padding: 10px; position: relative;" aria-label="Wishlist">
                    <i class="fas fa-heart"></i>
                </a>
                {% endif %}

                <!-- Cart -->
                <a href="{% url 'cart' %}" class="btn-neu" style="padding: 10px; position: relative;" aria-label="Shopping cart">
                    <i class="fas fa-shopping-cart"></i>
                    {% if user.is_authenticated %}
                    <span id="cart-count" style="position: absolute; top: -5px; right: -5px; background: var(--accent-color); color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 12px;">
                        {% with cart=user.cart_set.first %}
                            {{ cart.get_items_count|default:0 }}
                        {% endwith %}
                    </span>
                    {% endif %}
                </a>

                <!-- Mobile menu button -->
                <button id="mobile-menu-btn" class="btn-neu" style="padding: 10px; display: none;" aria-label="Open menu" aria-expanded="false">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>

        <!-- Mobile Navigation -->
        <div id="mobile-menu" style="display: none; padding: 20px 0; border-top: 1px solid var(--secondary-color);">
            <nav style="display: flex; flex-direction: column; gap: 10px;">
                <a href="{% url 'product_list' %}" class="btn-neu" style="justify-content: flex-start;">
                    <i class="fas fa-store"></i>
                    <span>Products</span>
                </a>
                <a href="{% url 'category_list' %}" class="btn-neu" style="justify-content: flex-start;">
                    <i class="fas fa-tags"></i>
                    <span>Categories</span>
                </a>
                <a href="{% url 'about' %}" class="btn-neu" style="justify-content: flex-start;">
                    <i class="fas fa-info-circle"></i>
                    <span>About</span>
                </a>
                <a href="{% url 'contact' %}" class="btn-neu" style="justify-content: flex-start;">
                    <i class="fas fa-envelope"></i>
                    <span>Contact</span>
                </a>

                {% if user.is_authenticated %}
                <a href="{% url 'order_history' %}" class="btn-neu" style="justify-content: flex-start;">
                    <i class="fas fa-user"></i>
                    <span>My Account</span>
                </a>
                <a href="{% url 'wishlist' %}" class="btn-neu" style="justify-content: flex-start;">
                    <i class="fas fa-heart"></i>
                    <span>Wishlist</span>
                </a>
                <a href="{% url 'logout' %}" class="btn-neu" style="justify-content: flex-start;">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </a>
                {% else %}
                <a href="{% url 'login' %}" class="btn-neu" style="justify-content: flex-start;">
                    <i class="fas fa-sign-in-alt"></i>
                    <span>Login</span>
                </a>
                <a href="{% url 'register' %}" class="btn-neu" style="justify-content: flex-start;">
                    <i class="fas fa-user-plus"></i>
                    <span>Register</span>
                </a>
                {% endif %}

                <!-- Theme toggle in mobile menu -->
                <button id="mobile-theme-toggle" class="btn-neu" style="justify-content: flex-start;">
                    <i class="fas fa-moon"></i>
                    <span>Dark Mode</span>
                </button>
            </nav>
        </div>
    </div>
</header>

<style>
    /* Header specific styles */
    header {
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(10px);
        background-color: rgba(230, 233, 239, 0.8);
    }

    [data-theme="dark"] header {
        background-color: rgba(42, 45, 54, 0.8);
    }

    /* Navigation improvements */
    nav a.btn-neu,
    .btn-neu {
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 8px;
        white-space: nowrap;
    }

    /* Mobile responsiveness */
    @media (max-width: 1024px) {
        .search-container input {
            width: 150px !important;
        }
    }

    @media (max-width: 968px) {
        .search-container {
            display: none !important;
        }

        nav:not(#mobile-menu nav) a span {
            display: none;
        }

        nav:not(#mobile-menu nav) a {
            padding: 10px 12px !important;
        }
    }

    @media (max-width: 768px) {
        nav:not(#mobile-menu nav) {
            display: none !important;
        }

        #mobile-menu-btn {
            display: flex !important;
            align-items: center;
            justify-content: center;
        }

        #mobile-menu.active {
            display: block !important;
        }

        #logo h1 span {
            display: none;
        }
    }

    @media (max-width: 480px) {
        .btn-neu {
            padding: 8px 12px !important;
        }

        #theme-toggle {
            display: none !important;
        }
    }
</style>

<script>
    // Sync mobile theme toggle with desktop
    document.addEventListener('DOMContentLoaded', function() {
        const themeToggle = document.getElementById('theme-toggle');
        const mobileThemeToggle = document.getElementById('mobile-theme-toggle');

        if (mobileThemeToggle) {
            mobileThemeToggle.addEventListener('click', function() {
                if (themeToggle) themeToggle.click();
            });
        }

        // Update mobile toggle text based on current theme
        function updateMobileToggleText() {
            if (!mobileThemeToggle) return;

            const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
            mobileThemeToggle.querySelector('span').textContent = isDark ? 'Light Mode' : 'Dark Mode';
            mobileThemeToggle.querySelector('i').className = isDark ? 'fas fa-sun' : 'fas fa-moon';
        }

        // Initial update
        updateMobileToggleText();

        // Listen for theme changes
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.attributeName === 'data-theme') {
                    updateMobileToggleText();
                }
            });
        });

        observer.observe(document.documentElement, {
            attributes: true
        });
    });
</script>
